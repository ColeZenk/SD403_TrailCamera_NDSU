# Software Design Description 003 | LoRa Calculations

### Set Baud : 115200
NOTE:  This does not work how one would thing "normal UART" works.

| Transmitter | ESP32-S3 TX → REYAX RX  AT+SEND=... | Command to send            |
| Transmitter | REYAX TX → ESP32-S3 RX +OK          | Acknowledgment             |
| Receiver    | REYAX TX → DevKitV1 RX +RCV=...     | Incoming data notification |
This took me longer than it should have to figure out.


## Spreading Factor Set for 2 Miles


| Spreading factor | Receiver sensitivity for bandwidth fixed at 125 kHz |
|------------------|-----------------------------------------------------|
| SF7              | -123 dBm                                            |
| SF8              | -126 dBm                                            |
| SF9              | -129 dBm                                            |
| SF10             | -132 dBm                                            |
| SF11             | -134.5 dBm                                          |
| SF12             | -137 dBm                                            |

### REYAX RYLR Specs:

$$
f = 915 MHz = 915 \times 10^{6} \\
T_{x} = +13 dBm (power) \\
gain = ~+2dB_{i} \\
D : 2 miles = ~3.22 Km \\
C : 299792458 \frac{m}{s} \\
$$

Formula: free space path loss

$$
FSPL(dB) = 20 (log_{10}(d) + log_{10}(f) + log_{10}(\frac{4\pi}{C})) - (G_{T_{x}} - G_{R_{x}}) \\
= 20 log_{10}(d \times f \times \frac{4\pi}{C}) = 20 log_{10}(3200 \times 915 \times 10^{6} \times \frac{4\pi}{C})  - (4) \\
= 97.7792 dB \\
$$

This assuming ~15 dB of loss

$$
P_{R} =  +13 - 97.7792 dB - 15 = - 99.792
$$


| SF7 | -123 dBm | 23.22   |
| SF8 | -126 dBm | 26.22   |
| SF9 | -129 dBm | 29.2203 |

Bit Rates:

$$
\Delta f  = 125 kHz \rightarrow X = SF \times \frac{\Delta f}{2^{SF}} \times R_{c} \\
R_{c} = \frac{4}{5}
$$
This is assuming that for every 4 bits theres odd 1 parity.

$$
SF7 : X = 5468.75 b/s \\
SF8 : X = 3125 b/s \\
SF9 : 1757.81 b/s
$$

SF7 should provide adequate range. If this turns out to be functionally false a dynamic range will need to be implemented.
